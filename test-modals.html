<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Modals de Feedback</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 10px;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #45a049;
        }
        .status {
            margin-top: 20px;
            padding: 10px;
            border-radius: 4px;
        }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
    </style>
</head>
<body>
    <h1>üß™ Teste de Modals de Feedback</h1>
    
    <div class="test-section">
        <h2>Teste 1: Modal de Sucesso</h2>
        <p>Clique no bot√£o abaixo para exibir o modal de sucesso. Depois clique em "OK, Entendi" para fechar.</p>
        <button onclick="testarModalSucesso()">Testar Modal de Sucesso</button>
    </div>
    
    <div class="test-section">
        <h2>Teste 2: Modal de Erro de Valida√ß√£o</h2>
        <p>Clique no bot√£o abaixo para exibir o modal de erro de valida√ß√£o. Depois clique em "Ver Primeiro Erro" para fechar.</p>
        <button onclick="testarModalValidacao()">Testar Modal de Valida√ß√£o</button>
    </div>
    
    <div class="test-section">
        <h2>Teste 3: Modal de Erro do Banco</h2>
        <p>Clique no bot√£o abaixo para exibir o modal de erro do banco. Depois clique em "Fechar" para fechar.</p>
        <button onclick="testarModalBanco()">Testar Modal de Banco</button>
    </div>
    
    <div class="test-section">
        <h2>Teste 4: Fun√ß√£o fecharFeedback()</h2>
        <p>Teste direto da fun√ß√£o global.</p>
        <button onclick="testarFuncaoGlobal()">Testar fecharFeedback() diretamente</button>
        <div id="resultado-funcao"></div>
    </div>
    
    <div id="status" class="status info" style="display:none;"></div>
    
    <!-- Carregar UIFeedback -->
    <script src="/js/ui-feedback.js"></script>
    
    <script>
        function mostrarStatus(mensagem, tipo = 'info') {
            const status = document.getElementById('status');
            status.className = `status ${tipo}`;
            status.textContent = mensagem;
            status.style.display = 'block';
            setTimeout(() => status.style.display = 'none', 3000);
        }
        
        function testarModalSucesso() {
            console.log('üß™ Testando modal de sucesso...');
            if (typeof UIFeedback !== 'undefined') {
                UIFeedback.mostrarSucesso('Empresa Teste Log√≠stica', 'teste_resposta.xlsx');
                mostrarStatus('‚úÖ Modal de sucesso exibido. Clique em "OK, Entendi" para testar o fechamento.', 'success');
            } else {
                mostrarStatus('‚ùå UIFeedback n√£o carregado', 'error');
            }
        }
        
        function testarModalValidacao() {
            console.log('üß™ Testando modal de valida√ß√£o...');
            if (typeof UIFeedback !== 'undefined') {
                UIFeedback.mostrarErroValidacao('Existem 3 campos obrigat√≥rios n√£o preenchidos.', [
                    { field: 'nome', message: 'Nome √© obrigat√≥rio' },
                    { field: 'email', message: 'Email √© obrigat√≥rio' },
                    { field: 'telefone', message: 'Telefone √© obrigat√≥rio' }
                ]);
                mostrarStatus('‚úÖ Modal de valida√ß√£o exibido. Clique em "Ver Primeiro Erro" para testar o fechamento.', 'success');
            } else {
                mostrarStatus('‚ùå UIFeedback n√£o carregado', 'error');
            }
        }
        
        function testarModalBanco() {
            console.log('üß™ Testando modal de erro do banco...');
            if (typeof UIFeedback !== 'undefined') {
                UIFeedback.mostrarErroBanco('Erro de integridade no banco de dados: CNPJ j√° cadastrado');
                mostrarStatus('‚úÖ Modal de banco exibido. Clique em "Fechar" para testar o fechamento.', 'success');
            } else {
                mostrarStatus('‚ùå UIFeedback n√£o carregado', 'error');
            }
        }
        
        function testarFuncaoGlobal() {
            console.log('üß™ Testando fun√ß√£o global fecharFeedback()...');
            const resultado = document.getElementById('resultado-funcao');
            
            if (typeof window.fecharFeedback === 'function') {
                resultado.innerHTML = '<div class="status success">‚úÖ Fun√ß√£o fecharFeedback() existe no window</div>';
                console.log('‚úÖ window.fecharFeedback:', window.fecharFeedback);
                
                // Tentar chamar
                try {
                    window.fecharFeedback();
                    resultado.innerHTML += '<div class="status success">‚úÖ Fun√ß√£o executada sem erros</div>';
                } catch (error) {
                    resultado.innerHTML += '<div class="status error">‚ùå Erro ao executar: ' + error.message + '</div>';
                }
            } else {
                resultado.innerHTML = '<div class="status error">‚ùå Fun√ß√£o fecharFeedback() N√ÉO encontrada no window</div>';
                console.error('‚ùå window.fecharFeedback n√£o existe');
                console.log('window keys:', Object.keys(window).filter(k => k.includes('fecha')));
            }
        }
        
        // Verificar carregamento
        window.addEventListener('load', () => {
            console.log('üìã Verificando componentes carregados...');
            console.log('UIFeedback:', typeof UIFeedback);
            console.log('window.fecharFeedback:', typeof window.fecharFeedback);
            
            if (typeof UIFeedback === 'undefined') {
                mostrarStatus('‚ö†Ô∏è AVISO: UIFeedback n√£o foi carregado. Verifique o caminho do script.', 'error');
            } else if (typeof window.fecharFeedback !== 'function') {
                mostrarStatus('‚ö†Ô∏è AVISO: window.fecharFeedback n√£o est√° dispon√≠vel', 'error');
            } else {
                mostrarStatus('‚úÖ Todos os componentes carregados corretamente', 'success');
            }
        });
    </script>
</body>
</html>
