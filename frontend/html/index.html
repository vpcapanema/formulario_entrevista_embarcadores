<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>PLI 2050 - Formul√°rio de Entrevistas com Embarcadores</title>
    <link rel="icon" type="image/svg+xml" href="/assets/favicon.svg">
    <!-- CSS Modularizado: Estilos globais + valida√ß√£o -->
    <link rel="stylesheet" href="/css/index.css?v=20251106">
    <link rel="stylesheet" href="/css/validacao-visual.css?v=20251106">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
</head>
<body>
    <!-- Navega√ß√£o -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <h1>PLI 2050 - SP</h1>
                <p>Plano de Log√≠stica e Investimentos</p>
            </div>
            <div class="nav-menu">
                <button class="nav-btn active" onclick="showPage('formulario')">
                    <span>üìã</span> Formul√°rio
                </button>
                <button class="nav-btn" onclick="showPage('respostas')">
                    <span>üìä</span> Respostas
                </button>
                <button class="nav-btn" onclick="showPage('analytics')">
                    <span>üìà</span> Analytics
                </button>
                <button class="nav-btn" onclick="showPage('instrucoes')">
                    <span>üìñ</span> Instru√ß√µes
                </button>
                <button class="nav-btn" onclick="showPage('visualizador')">
                    <span>ÔøΩ</span> Visualizador
                </button>
            </div>
        </div>
    </nav>

    <!-- P√°gina 1: Formul√°rio -->
    <div id="page-formulario" class="page active">
        <div class="container">
            <div class="page-header">
                <h2>Formul√°rio de Entrevista com Embarcadores</h2>
                <p>Caracteriza√ß√£o do transporte de mercadorias no Estado de S√£o Paulo</p>
            </div>

            <form id="entrevista-form">
                <!-- Card 0: Respons√°vel pelo Preenchimento -->
                <div class="card" id="card-0">
                    <div class="card-header centered">
                        <h3>Respons√°vel pelo Preenchimento</h3>
                        <p class="card-intro">Quem est√° preenchendo este formul√°rio?</p>
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Quem est√° preenchendo este formul√°rio? *</label>
                                <div class="radio-group">
                                    <label class="radio-label">
                                        <input type="radio" name="tipo-responsavel" value="entrevistado" required>
                                        <span>Entrevistado (Representante da empresa)</span>
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="tipo-responsavel" value="entrevistador" required>
                                        <span>Entrevistador (Consultor/Pesquisador)</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Campo condicional: Selecionar Entrevistador -->
                        <div class="form-row hidden-field" id="selecionar-entrevistador-container">
                            <div class="form-group">
                                <label for="id-entrevistador">Selecione o entrevistador *</label>
                                <select id="id-entrevistador" name="id-entrevistador">
                                    <option value="">Selecione um entrevistador</option>
                                </select>
                                <p class="help-text">Se voc√™ n√£o encontrar seu nome na lista, entre em contato com o administrador do sistema.</p>
                            </div>
                        </div>

                        <!-- Informa√ß√£o para entrevistado -->
                        <div class="form-row" id="info-entrevistado-container">
                            <div class="form-group">
                                <div class="info-box">
                                    <p><strong>‚ÑπÔ∏è Informa√ß√£o:</strong> Voc√™ est√° preenchendo o formul√°rio como representante da empresa. Suas informa√ß√µes de contato ser√£o solicitadas na pr√≥xima se√ß√£o.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Card 1: Dados do Entrevistado -->
                <div class="card" id="card-1">
                    <div class="card-header">
                        <h3>1 - Dados do Entrevistado</h3>
                        <p class="card-intro">Informa√ß√µes de contato da pessoa respons√°vel pelas informa√ß√µes log√≠sticas.</p>
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="nome"><span class="question-number">1.</span> Nome *</label>
                                <input type="text" id="nome" name="nome" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="funcao-entrevistado"><span class="question-number">2.</span> Fun√ß√£o *</label>
                                <select id="funcao-entrevistado" name="funcao-entrevistado" required>
                                    <option value="">Carregando fun√ß√µes...</option>
                                </select>
                                <small class="field-hint">Selecione a fun√ß√£o/cargo do entrevistado na empresa</small>
                                <!-- Campo condicional para "Outro" -->
                                <div class="hidden-field hidden-field-spaced" id="outra-funcao-container">
                                    <label for="outra-funcao">Especifique a fun√ß√£o:</label>
                                    <input type="text" id="outra-funcao" name="outra-funcao">
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="telefone"><span class="question-number">3.</span> Telefone *</label>
                                <input type="tel" id="telefone" name="telefone" required>
                            </div>
                            <div class="form-group">
                                <label for="email"><span class="question-number">4.</span> E-mail *</label>
                                <input type="email" id="email" name="email" required>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Card 2: Dados da Empresa -->
                <div class="card" id="card-2">
                    <div class="card-header">
                        <h3>2 - Dados da Empresa</h3>
                        <p class="card-intro">Caracteriza√ß√£o geral da empresa e suas atividades log√≠sticas.</p>
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="tipo-empresa"><span class="question-number">5.</span> A empresa √© um: *</label>
                                <select id="tipo-empresa" name="tipo-empresa" required>
                                    <option value="">Selecione...</option>
                                    <option value="embarcador">Embarcador (dono da carga)</option>
                                    <option value="transportador">Transportador (prestador de servi√ßos de transporte)</option>
                                    <option value="operador">Operador log√≠stico (gest√£o e integra√ß√£o de servi√ßos)</option>
                                    <option value="outro">Outro</option>
                                </select>
                                <!-- Campo condicional inline -->
                                <div class="hidden-field hidden-field-spaced" id="outro-tipo-container">
                                    <label for="outro-tipo">Especifique:</label>
                                    <input type="text" id="outro-tipo" name="outro-tipo">
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="cnpj-empresa"><span class="question-number">6a.</span> CNPJ *</label>
                                <input type="text" id="cnpj-empresa" name="cnpj-empresa" required 
                                       placeholder="00.000.000/0000-00" 
                                       maxlength="18">
                                <small class="field-hint" id="cnpj-status"></small>
                            </div>
                            <div class="form-group">
                                <label for="nome-empresa"><span class="question-number">6b.</span> Nome da empresa *</label>
                                <input type="text" id="nome-empresa" name="nome-empresa" required readonly
                                       placeholder="Ser√° preenchido automaticamente ao digitar o CNPJ"
                                       class="readonly-field">
                                <small class="field-hint">Raz√£o social obtida da Receita Federal</small>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="municipio-empresa"><span class="question-number">7.</span> Munic√≠pio da(s) unidade(s) de produ√ß√£o *</label>
                                <select id="municipio-empresa" name="municipio-empresa" required>
                                    <option value="">Carregando munic√≠pios...</option>
                                </select>
                                <small class="field-hint">Selecione o munic√≠pio onde a empresa est√° localizada (S√£o Paulo)</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Card 3: Produtos Transportados -->
                <div class="card" id="card-3">
                    <div class="card-header">
                        <h3>3 - Produtos Transportados</h3>
                        <p class="card-intro">Informa√ß√µes sobre os principais produtos expedidos/transportados pela empresa.</p>
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="form-group">
                                <label><span class="question-number">8.</span> Principais produtos e suas caracter√≠sticas:</label>
                                <p class="help-text">Adicione os principais produtos transportados. Para cada produto, informe a movimenta√ß√£o anual, origem, destino, dist√¢ncia, modalidade e acondicionamento.</p>
                                <button type="button" class="btn-add" onclick="addProdutoRow()">+ Adicionar Produto</button>
                            </div>
                        </div>
                        <div id="produtos-container" class="table-container">
                            <table id="produtos-table">
                                <thead>
                                    <tr>
                                        <th>Carga Transportada</th>
                                        <th>Movimenta√ß√£o (ton/ano)</th>
                                        <th>Origem</th>
                                        <th>Destino</th>
                                        <th>Dist√¢ncia (km)</th>
                                        <th>Modalidade</th>
                                        <th>Acondicionamento</th>
                                        <th>A√ß√µes</th>
                                    </tr>
                                </thead>
                                <tbody id="produtos-tbody">
                                    <!-- Linhas ser√£o adicionadas dinamicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Card 4: Produto Principal -->
                <div class="card" id="card-4">
                    <div class="card-header">
                        <h3>4 - Caracteriza√ß√£o do Produto Principal</h3>
                        <p class="card-intro">Entre os produtos mencionados acima, indique aquele que √© mais representativo para a empresa. As pr√≥ximas perguntas focar√£o neste produto espec√≠fico.</p>
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="produto-principal"><span class="question-number">9.</span> Produto mais representativo *</label>
                                <input type="text" id="produto-principal" name="produto-principal" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="agrupamento-produto"><span class="question-number">10.</span> Este produto se encaixa em qual agrupamento? *</label>
                                <select id="agrupamento-produto" name="agrupamento-produto" required>
                                    <option value="">Selecione...</option>
                                    <option value="acucar">A√ß√∫car</option>
                                    <option value="adubos">Adubos e fertilizantes</option>
                                    <option value="alimentos-industrializados">Alimentos industrializados</option>
                                    <option value="suco-laranja">Suco de laranja</option>
                                    <option value="animais-vivos">Animais vivos</option>
                                    <option value="arroz">Arroz</option>
                                    <option value="bebidas">Bebidas</option>
                                    <option value="biocombustiveis">Biocombust√≠veis</option>
                                    <option value="cafe">Caf√©</option>
                                    <option value="cha-mate">Ch√°, mate e especiarias</option>
                                    <option value="cargas-especiais">Cargas especiais</option>
                                    <option value="carnes">Carnes</option>
                                    <option value="carvao-mineral">Carv√£o mineral</option>
                                    <option value="cimento">Cimento</option>
                                    <option value="combustiveis">Combust√≠veis derivados do petr√≥leo</option>
                                    <option value="eletronicos">Eletr√¥nicos</option>
                                    <option value="embalagens">Embalagens pl√°sticas, botij√µes para g√°s, pallets de madeira e garrafas de vidro</option>
                                    <option value="farelo-soja">Farelo de soja</option>
                                    <option value="hortifruti">Hortifruti</option>
                                    <option value="glp">GLP</option>
                                    <option value="defensivos">Defensivos agr√≠colas</option>
                                    <option value="laticinios">Latic√≠nios e outros alimentos de origem animal</option>
                                    <option value="madeira-carvao">Madeira e carv√£o</option>
                                    <option value="maquinas-eletricas">M√°quinas, aparelhos e materiais el√©tricos</option>
                                    <option value="medicamentos">Medicamentos</option>
                                    <option value="milho">Milho</option>
                                    <option value="minerio-ferro">Min√©rio de ferro</option>
                                    <option value="obras-ferro-aco">Obras de ferro ou a√ßo</option>
                                    <option value="oleo-bruto">√ìleo bruto</option>
                                    <option value="algodao">Algod√£o</option>
                                    <option value="cana-acucar">Cana-de-a√ß√∫car</option>
                                    <option value="cereais">Cereais</option>
                                    <option value="oleos-vegetais">√ìleos vegetais e animais</option>
                                    <option value="oleos-vegetais-bruto">√ìleos vegetais em bruto</option>
                                    <option value="outras-cgc">Outras CGC</option>
                                    <option value="outros-gl">Outros GL</option>
                                    <option value="madeira-bruto">Madeira em bruto</option>
                                    <option value="materiais-construcao">Materiais de Constru√ß√£o</option>
                                    <option value="outras-cgnc">Outras CGNC</option>
                                    <option value="calcario">Calc√°rio</option>
                                    <option value="enxofre">Enxofre</option>
                                    <option value="minerais-contenteirizaveis">Minerais Conteneiriz√°veis</option>
                                    <option value="minerais-metalicos">Minerais met√°licos n√£o ferrosos</option>
                                    <option value="minerio-aluminio">Min√©rio de alum√≠nio</option>
                                    <option value="outros-gsm">Outros GSM</option>
                                    <option value="produtos-quimicos-gs">Produtos qu√≠micos em GS</option>
                                    <option value="celulose">Celulose</option>
                                    <option value="papel">Papel</option>
                                    <option value="petroquimicos-solidos">Petroqu√≠micos s√≥lidos</option>
                                    <option value="plasticos">Pl√°sticos e suas obras</option>
                                    <option value="pneus-componentes">Pneus, componentes e acess√≥rios de autom√≥veis</option>
                                    <option value="higiene-limpeza">Produtos de higiene e limpeza</option>
                                    <option value="produtos-quimicos">Produtos qu√≠micos</option>
                                    <option value="produtos-quimicos-gl">Produtos qu√≠micos em GL</option>
                                    <option value="soda-caustica">Soda c√°ustica</option>
                                    <option value="produtos-metalurgicos">Produtos metal√∫rgicos</option>
                                    <option value="racao-animal">Ra√ß√£o animal e desperd√≠cios das ind√∫strias alimentares</option>
                                    <option value="sal">Sal</option>
                                    <option value="soja">Soja</option>
                                    <option value="trigo">Trigo</option>
                                    <option value="veiculos">Ve√≠culos automotivos</option>
                                    <option value="vestuario">Vestu√°rio</option>
                                    <option value="outro-produto">Outro</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row hidden-field" id="outro-produto-container">
                            <div class="form-group">
                                <label for="outro-produto">Especifique o produto:</label>
                                <input type="text" id="outro-produto" name="outro-produto">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Card 5: Caracter√≠sticas do Transporte -->
                <div class="card" id="card-5">
                    <div class="card-header">
                        <h3>5 - Caracter√≠sticas do Transporte</h3>
                        <p class="card-intro">Detalhes sobre origem, destino, modalidade e especifica√ß√µes t√©cnicas do transporte do produto principal.</p>
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="tipo-transporte"><span class="question-number">11.</span> O transporte desse material refere-se a: *</label>
                                <select id="tipo-transporte" name="tipo-transporte" required>
                                    <option value="">Selecione...</option>
                                    <option value="importacao">Importa√ß√£o</option>
                                    <option value="exportacao">Exporta√ß√£o</option>
                                    <option value="local">Transporte Local</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="origem-pais"><span class="question-number">12.</span> Pa√≠s de Origem *</label>
                                <select id="origem-pais" name="origem-pais" required>
                                    <option value="">Carregando pa√≠ses...</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="origem-estado">Estado de Origem</label>
                                <select id="origem-estado" name="origem-estado" disabled>
                                    <option value="">Primeiro selecione o pa√≠s</option>
                                </select>
                                <small class="field-hint">Habilitado apenas se Pa√≠s = Brasil</small>
                            </div>
                            <div class="form-group">
                                <label for="origem-municipio">Munic√≠pio de Origem</label>
                                <select id="origem-municipio" name="origem-municipio" disabled>
                                    <option value="">Primeiro selecione o estado</option>
                                </select>
                                <small class="field-hint">Habilitado ap√≥s selecionar estado brasileiro</small>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="destino-pais"><span class="question-number">13.</span> Pa√≠s de Destino *</label>
                                <select id="destino-pais" name="destino-pais" required>
                                    <option value="">Carregando pa√≠ses...</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="destino-estado">Estado de Destino</label>
                                <select id="destino-estado" name="destino-estado" disabled>
                                    <option value="">Primeiro selecione o pa√≠s</option>
                                </select>
                                <small class="field-hint">Habilitado apenas se Pa√≠s = Brasil</small>
                            </div>
                            <div class="form-group">
                                <label for="destino-municipio">Munic√≠pio de Destino</label>
                                <select id="destino-municipio" name="destino-municipio" disabled>
                                    <option value="">Primeiro selecione o estado</option>
                                </select>
                                <small class="field-hint">Habilitado ap√≥s selecionar estado brasileiro</small>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="distancia"><span class="question-number">14.</span> Dist√¢ncia do deslocamento (km) *</label>
                                <input type="number" id="distancia" name="distancia" min="0" required>
                            </div>
                            <div class="form-group">
                                <label for="tem-paradas"><span class="question-number">15.</span> Esse deslocamento tem paradas? *</label>
                                <select id="tem-paradas" name="tem-paradas" required>
                                    <option value="">Selecione...</option>
                                    <option value="sim">Sim</option>
                                    <option value="nao">N√£o</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="num-paradas"><span class="question-number">16.</span> N√∫mero de paradas *</label>
                                <select id="num-paradas" name="num-paradas" required onchange="toggleParadasExato()">
                                    <option value="">Selecione...</option>
                                    <option value="0">0 paradas</option>
                                    <option value="1">1 parada</option>
                                    <option value="2">2 paradas</option>
                                    <option value="3">3 paradas</option>
                                    <option value="4">4 paradas</option>
                                    <option value="5">5 paradas</option>
                                    <option value="6">6 paradas</option>
                                    <option value="7">7 paradas</option>
                                    <option value="8">8 paradas</option>
                                    <option value="9">9 paradas</option>
                                    <option value="10">10 paradas</option>
                                    <option value="11">Mais de 10 paradas (especificar abaixo)</option>
                                </select>
                                <!-- Campo condicional: exato se > 10 -->
                                <div class="hidden-field hidden-field-spaced" id="num-paradas-exato-container">
                                    <label for="num-paradas-exato">N√∫mero exato de paradas *</label>
                                    <input type="number" id="num-paradas-exato" name="num-paradas-exato" min="11" placeholder="Exemplo: 15">
                                    <small class="field-hint">Digite o n√∫mero exato de paradas (m√≠nimo 11)</small>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label><span class="question-number">17.</span> Modo(s) utilizado(s) nesse deslocamento: * (pode marcar mais de um)</label>
                                <div class="checkbox-group">
                                    <label><input type="checkbox" name="modo" value="rodoviario"> Rodovi√°rio</label>
                                    <label><input type="checkbox" name="modo" value="ferroviario"> Ferrovi√°rio</label>
                                    <label><input type="checkbox" name="modo" value="hidroviario"> Hidrovi√°rio</label>
                                    <label><input type="checkbox" name="modo" value="cabotagem"> Cabotagem</label>
                                    <label><input type="checkbox" name="modo" value="dutoviario"> Dutovi√°rio</label>
                                    <label><input type="checkbox" name="modo" value="aeroviario"> Aerovi√°rio</label>
                                </div>
                                <!-- Campo condicional Q18 -->
                                <div class="hidden-field hidden-field-spaced" id="config-veiculo-container">
                                    <label for="config-veiculo"><span class="question-number">18.</span> Configura√ß√£o do ve√≠culo rodovi√°rio:</label>
                                    <select id="config-veiculo" name="config-veiculo">
                                        <option value="">Selecione...</option>
                                        <option value="leve">Ve√≠culo leve (VUC / caminhonete / furg√£o)</option>
                                        <option value="simples">Caminh√£o unidade simples, com carroceria fixa (ex.: Toco, truck, ba√∫ r√≠gido)</option>
                                        <option value="semirreboque">Caminh√£o semirreboque (ex.: carreta)</option>
                                        <option value="reboque">Caminh√£o com reboque (ex.: bitrem, rodotrem, cegonheira, reboque tanque)</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="capacidade-utilizada"><span class="question-number">19.</span> Capacidade do ve√≠culo utilizada (%) *</label>
                                <input type="number" id="capacidade-utilizada" name="capacidade-utilizada" 
                                       min="0" max="100" step="0.1" 
                                       placeholder="Ex: 85.5" required>
                                <small class="field-hint">Digite a porcentagem exata de capacidade utilizada (0 a 100%)</small>
                            </div>
                            <div class="form-group">
                                <label for="peso-carga"><span class="question-number">20.</span> Peso da carga *</label>
                                <input type="number" id="peso-carga" name="peso-carga" min="0" step="0.01" required>
                            </div>
                            <div class="form-group">
                                <label for="unidade-peso"><span class="question-number">21.</span> Unidade *</label>
                                <select id="unidade-peso" name="unidade-peso" required>
                                    <option value="kg">kg</option>
                                    <option value="toneladas">toneladas</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="custo-transporte"><span class="question-number">22.</span> Custo total do transporte (R$) *</label>
                                <input type="number" id="custo-transporte" name="custo-transporte" min="0" step="0.01" required>
                            </div>
                            <div class="form-group">
                                <label for="valor-carga"><span class="question-number">23.</span> Valor total da carga (R$) *</label>
                                <input type="number" id="valor-carga" name="valor-carga" min="0" step="0.01" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="tipo-embalagem"><span class="question-number">24.</span> Tipo de embalagem *</label>
                                <select id="tipo-embalagem" name="tipo-embalagem" required>
                                    <option value="">Selecione...</option>
                                    <option value="granel-solido">Granel s√≥lido</option>
                                    <option value="granel-liquido">Granel l√≠quido</option>
                                    <option value="fracionada">Carga fracionada / avulsa</option>
                                    <option value="conteiner-20">Cont√™iner FTL (20') - Full Truck Load</option>
                                    <option value="conteiner-40">Cont√™iner FTL (40') - Full Truck Load</option>
                                    <option value="conteiner-ltc">Cont√™iner LTC - Less Than Container</option>
                                    <option value="carga-geral">Carga geral</option>
                                    <option value="carga-expressa">Carga expressa / encomenda</option>
                                    <option value="nao-informado">N√£o informado</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="carga-perigosa"><span class="question-number">25.</span> √â uma carga perigosa? *</label>
                                <select id="carga-perigosa" name="carga-perigosa" required>
                                    <option value="">Selecione...</option>
                                    <option value="sim">Sim</option>
                                    <option value="nao">N√£o</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="tempo-dias"><span class="question-number">26.</span> Tempo de deslocamento - Dias *</label>
                                <input type="number" id="tempo-dias" name="tempo-dias" min="0" placeholder="Dias" required>
                            </div>
                            <div class="form-group">
                                <label for="tempo-horas">Horas *</label>
                                <input type="number" id="tempo-horas" name="tempo-horas" min="0" max="23" placeholder="Horas" required>
                            </div>
                            <div class="form-group">
                                <label for="tempo-minutos">Minutos *</label>
                                <input type="number" id="tempo-minutos" name="tempo-minutos" min="0" max="59" placeholder="Minutos" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="frequencia"><span class="question-number">27.</span> Frequ√™ncia aproximada de deslocamento dessa carga *</label>
                                <select id="frequencia" name="frequencia" required>
                                    <option value="">Selecione...</option>
                                    <option value="diaria">Di√°ria</option>
                                    <option value="mais-1x-semana">Mais de 1x por semana</option>
                                    <option value="1x-semana">1x por semana</option>
                                    <option value="1x-mes">1x por m√™s</option>
                                    <option value="eventual">Eventual</option>
                                    <option value="outra">Outra</option>
                                </select>
                                <!-- Campo condicional Q28 -->
                                <div class="hidden-field hidden-field-spaced" id="frequencia-diaria-container">
                                    <label for="frequencia-diaria"><span class="question-number">28.</span> Quantas vezes no dia?</label>
                                    <input type="number" id="frequencia-diaria" name="frequencia-diaria" 
                                           min="0.5" max="100" step="0.5" 
                                           placeholder="Ex: 2.5">
                                    <small class="field-hint">Digite o n√∫mero de viagens por dia (pode usar decimais, ex: 2.5)</small>
                                </div>
                                <!-- Campo condicional Q-outra -->
                                <div class="hidden-field hidden-field-spaced" id="frequencia-outra-container">
                                    <label for="frequencia-outra">Especifique a frequ√™ncia:</label>
                                    <input type="text" id="frequencia-outra" name="frequencia-outra">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Card 6: Fatores de Decis√£o Modal -->
                <div class="card" id="card-6">
                    <div class="card-header">
                        <h3>6 - Fatores de Decis√£o Modal</h3>
                        <p class="card-intro">Avalia a import√¢ncia e sensibilidade a varia√ß√µes em 5 fatores principais:</p>
                        <ul class="intro-list">
                            <li><strong>CUSTO</strong> - Impacto dos custos de transporte</li>
                            <li><strong>TEMPO</strong> - Dura√ß√£o do transporte</li>
                            <li><strong>CONFIABILIDADE</strong> - Previsibilidade e pontualidade</li>
                            <li><strong>SEGURAN√áA</strong> - Prote√ß√£o contra perdas e danos</li>
                            <li><strong>CAPACIDADE</strong> - Volume que pode ser transportado</li>
                        </ul>
                    </div>
                    <div class="card-body">
                        <!-- CUSTO -->
                        <div class="form-row">
                            <div class="form-group">
                                <label for="importancia-custo"><span class="question-number">29.</span> üí∞ Import√¢ncia do CUSTO *</label>
                                <select id="importancia-custo" name="importancia-custo" required>
                                    <option value="">Selecione...</option>
                                    <option value="muito-alta">Muito alta</option>
                                    <option value="alta">Alta</option>
                                    <option value="media">M√©dia</option>
                                    <option value="baixa">Baixa</option>
                                    <option value="muito-baixa">Muito baixa</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="variacao-custo"><span class="question-number">30.</span> Varia√ß√£o % de CUSTO que mudaria sua forma de transporte *</label>
                                <input type="number" id="variacao-custo" name="variacao-custo" min="0" max="100" step="0.1" required>
                            </div>
                        </div>

                        <!-- TEMPO -->
                        <div class="form-row">
                            <div class="form-group">
                                <label for="importancia-tempo"><span class="question-number">31.</span> ‚è±Ô∏è Import√¢ncia do TEMPO *</label>
                                <select id="importancia-tempo" name="importancia-tempo" required>
                                    <option value="">Selecione...</option>
                                    <option value="muito-alta">Muito alta</option>
                                    <option value="alta">Alta</option>
                                    <option value="media">M√©dia</option>
                                    <option value="baixa">Baixa</option>
                                    <option value="muito-baixa">Muito baixa</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="variacao-tempo"><span class="question-number">32.</span> Varia√ß√£o % de TEMPO que mudaria sua forma de transporte *</label>
                                <input type="number" id="variacao-tempo" name="variacao-tempo" min="0" max="100" step="0.1" required>
                            </div>
                        </div>

                        <!-- CONFIABILIDADE -->
                        <div class="form-row">
                            <div class="form-group">
                                <label for="importancia-confiabilidade"><span class="question-number">33.</span> ‚úÖ Import√¢ncia da CONFIABILIDADE *</label>
                                <select id="importancia-confiabilidade" name="importancia-confiabilidade" required>
                                    <option value="">Selecione...</option>
                                    <option value="muito-alta">Muito alta</option>
                                    <option value="alta">Alta</option>
                                    <option value="media">M√©dia</option>
                                    <option value="baixa">Baixa</option>
                                    <option value="muito-baixa">Muito baixa</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="variacao-confiabilidade"><span class="question-number">34.</span> Varia√ß√£o % de CONFIABILIDADE que mudaria sua forma de transporte *</label>
                                <input type="number" id="variacao-confiabilidade" name="variacao-confiabilidade" min="0" max="100" step="0.1" required>
                            </div>
                        </div>

                        <!-- SEGURAN√áA -->
                        <div class="form-row">
                            <div class="form-group">
                                <label for="importancia-seguranca"><span class="question-number">35.</span> üîí Import√¢ncia da SEGURAN√áA *</label>
                                <select id="importancia-seguranca" name="importancia-seguranca" required>
                                    <option value="">Selecione...</option>
                                    <option value="muito-alta">Muito alta</option>
                                    <option value="alta">Alta</option>
                                    <option value="media">M√©dia</option>
                                    <option value="baixa">Baixa</option>
                                    <option value="muito-baixa">Muito baixa</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="variacao-seguranca"><span class="question-number">36.</span> Varia√ß√£o % de SEGURAN√áA que mudaria sua forma de transporte *</label>
                                <input type="number" id="variacao-seguranca" name="variacao-seguranca" min="0" max="100" step="0.1" required>
                            </div>
                        </div>

                        <!-- CAPACIDADE -->
                        <div class="form-row">
                            <div class="form-group">
                                <label for="importancia-capacidade"><span class="question-number">37.</span> üì¶ Import√¢ncia da CAPACIDADE *</label>
                                <select id="importancia-capacidade" name="importancia-capacidade" required>
                                    <option value="">Selecione...</option>
                                    <option value="muito-alta">Muito alta</option>
                                    <option value="alta">Alta</option>
                                    <option value="media">M√©dia</option>
                                    <option value="baixa">Baixa</option>
                                    <option value="muito-baixa">Muito baixa</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="variacao-capacidade"><span class="question-number">38.</span> Varia√ß√£o % de CAPACIDADE que mudaria sua forma de transporte *</label>
                                <input type="number" id="variacao-capacidade" name="variacao-capacidade" min="0" max="100" step="0.1" required>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Card 7: An√°lise Estrat√©gica -->
                <div class="card" id="card-7">
                    <div class="card-header">
                        <h3>7 - An√°lise Estrat√©gica</h3>
                        <p class="card-intro">Caracter√≠sticas da cadeia log√≠stica e disposi√ß√£o para utilizar modalidades alternativas.</p>
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="tipo-cadeia"><span class="question-number">39.</span> Esse transporte √© de Suprimento ou Distribui√ß√£o? *</label>
                                <select id="tipo-cadeia" name="tipo-cadeia" required>
                                    <option value="">Selecione...</option>
                                    <option value="suprimento">Cadeia de Suprimento (ex.: terminais ‚Üí ind√∫stria, ind√∫stria ‚Üí atacado/varejo)</option>
                                    <option value="distribuicao">Cadeia de Distribui√ß√£o (ex.: ind√∫stria ‚Üí terminais/armaz√©ns, atacado ‚Üí varejo)</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label><span class="question-number">40.</span> Voc√™ estaria disposto a utilizar alternativamente: (pode marcar mais de uma op√ß√£o)</label>
                                <div class="checkbox-group">
                                    <label><input type="checkbox" name="modal-alternativo" value="ferrovia"> Ferrovia</label>
                                    <label><input type="checkbox" name="modal-alternativo" value="hidrovia"> Hidrovia</label>
                                    <label><input type="checkbox" name="modal-alternativo" value="dutovia"> Dutovia</label>
                                    <label><input type="checkbox" name="modal-alternativo" value="cabotagem"> Cabotagem (mar√≠timo)</label>
                                    <label><input type="checkbox" name="modal-alternativo" value="nenhum"> Nenhum</label>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="fator-adicional"><span class="question-number">41.</span> Algum fator de import√¢ncia consider√°vel para a escolha modal n√£o foi citado anteriormente?</label>
                                <textarea id="fator-adicional" name="fator-adicional" rows="3"></textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Card 8: Dificuldades Log√≠sticas -->
                <div class="card" id="card-8">
                    <div class="card-header">
                        <h3>8 - Dificuldades em Rela√ß√£o √† Log√≠stica Geral</h3>
                        <p class="card-intro">Principais desafios enfrentados pela empresa nas atividades log√≠sticas e de transporte.</p>
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="form-group">
                                <label><span class="question-number">42.</span> Principais dificuldades enfrentadas: (pode marcar mais de uma op√ß√£o)</label>
                                <div class="checkbox-group">
                                    <label><input type="checkbox" name="dificuldade" value="infra-rodoviaria"> Inadequa√ß√£o da infraestrutura rodovi√°ria</label>
                                    <label><input type="checkbox" name="dificuldade" value="infra-ferroviaria"> Inadequa√ß√£o da infraestrutura ferrovi√°ria</label>
                                    <label><input type="checkbox" name="dificuldade" value="infra-portuaria"> Inadequa√ß√£o da infraestrutura portu√°ria</label>
                                    <label><input type="checkbox" name="dificuldade" value="infra-aeroviaria"> Inadequa√ß√£o da infraestrutura aerovi√°ria</label>
                                    <label><input type="checkbox" name="dificuldade" value="infra-dutoviaria"> Inadequa√ß√£o da infraestrutura dutovi√°ria</label>
                                    <label><input type="checkbox" name="dificuldade" value="centros-distribuicao"> Inexist√™ncia ou insufici√™ncia de centros de distribui√ß√£o</label>
                                    <label><input type="checkbox" name="dificuldade" value="terminais-intermodais"> Oferta insuficiente de terminais intermodais</label>
                                    <label><input type="checkbox" name="dificuldade" value="armazenagem"> Oferta insuficiente de instala√ß√µes de armazenagem</label>
                                    <label><input type="checkbox" name="dificuldade" value="acessos-portos"> Inadequa√ß√£o dos acessos aos portos e terminais</label>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="detalhe-dificuldade"><span class="question-number">43.</span> Detalhe sua dificuldade (especifique outras dificuldades ou forne√ßa mais detalhes):</label>
                                <textarea id="detalhe-dificuldade" name="detalhe-dificuldade" rows="4"></textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bot√µes de A√ß√£o -->
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="preencherFormularioCompletoTeste()" title="Preencher TODOS os campos automaticamente para teste">
                        üß™ Preencher Formul√°rio Completo de Teste
                    </button>
                    <button type="submit" class="btn-primary">üíæ Enviar Formul√°rio</button>
                    <button type="reset" class="btn-secondary">üîÑ Limpar Formul√°rio</button>
                </div>
            </form>
        </div>
    </div>

    <!-- P√°gina 2: Respostas -->
    <div id="page-respostas" class="page">
        <div class="container">
            <div class="page-header">
                <h2>Respostas Coletadas</h2>
                <p>Visualiza√ß√£o das entrevistas realizadas</p>
            </div>
            <div class="actions-bar">
                <button class="btn-primary" onclick="exportToExcel('respostas')">üìä Exportar para Excel</button>
                <button class="btn-primary" onclick="exportToCSV('respostas')">üìÑ Exportar para CSV</button>
                <button class="btn-secondary" onclick="deleteAllData()">üóëÔ∏è Limpar Todas as Respostas</button>
            </div>
            <div id="respostas-list">
                <!-- Conte√∫do ser√° carregado dinamicamente -->
            </div>
        </div>
    </div>

    <!-- P√°gina 3: Analytics -->
    <div id="page-analytics" class="page">
        <div class="container">
            <div class="page-header">
                <h2>Analytics - An√°lise de Dados</h2>
                <p>An√°lise consolidada de todas as entrevistas</p>
            </div>
            <div class="actions-bar">
                <button class="btn-primary" onclick="exportToPDF()">üìë Exportar para PDF</button>
                <button class="btn-primary" onclick="exportToExcel('analytics')">üìä Exportar para Excel</button>
                <button class="btn-primary" onclick="exportToCSV('analytics')">üìÑ Exportar para CSV</button>
            </div>
            
            <!-- KPIs -->
            <div class="kpi-grid" id="kpi-container">
                <!-- KPIs ser√£o carregados dinamicamente -->
            </div>

            <!-- Gr√°ficos -->
            <div class="charts-grid">
                <div class="card chart-card">
                    <h3>Distribui√ß√£o Modal</h3>
                    <canvas id="chart-modal"></canvas>
                </div>
                <div class="card chart-card">
                    <h3>Top 10 Produtos Transportados</h3>
                    <canvas id="chart-produtos"></canvas>
                </div>
                <div class="card chart-card">
                    <h3>Import√¢ncia dos Fatores de Decis√£o</h3>
                    <canvas id="chart-fatores"></canvas>
                </div>
                <div class="card chart-card">
                    <h3>Tipo de Embalagem</h3>
                    <canvas id="chart-embalagem"></canvas>
                </div>
                <div class="card chart-card">
                    <h3>Dificuldades Mais Citadas</h3>
                    <canvas id="chart-dificuldades"></canvas>
                </div>
                <div class="card chart-card">
                    <h3>Sensibilidade a Mudan√ßas (%)</h3>
                    <canvas id="chart-sensibilidade"></canvas>
                </div>
                <div class="card chart-card">
                    <h3>Custo M√©dio por Modalidade (R$/ton)</h3>
                    <canvas id="chart-custo-modal"></canvas>
                </div>
                <div class="card chart-card">
                    <h3>Taxa de Ocupa√ß√£o M√©dia por Modalidade (%)</h3>
                    <canvas id="chart-ocupacao"></canvas>
                </div>
                <div class="card chart-card">
                    <h3>Frequ√™ncia de Transporte</h3>
                    <canvas id="chart-frequencia"></canvas>
                </div>
                <div class="card chart-card">
                    <h3>Tipo de Cadeia Log√≠stica</h3>
                    <canvas id="chart-cadeia"></canvas>
                </div>
                <div class="card chart-card">
                    <h3>Disposi√ß√£o para Modais Alternativos</h3>
                    <canvas id="chart-alternativos"></canvas>
                </div>
                <div class="card chart-card">
                    <h3>Dist√¢ncia M√©dia por Modalidade (km)</h3>
                    <canvas id="chart-distancia"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- P√°gina 4: Instru√ß√µes -->
    <div id="page-instrucoes" class="page">
        <div class="container">
            <div class="page-header">
                <h2>üìã Instru√ß√µes de Preenchimento</h2>
                <p>Guia completo para preenchimento do Formul√°rio de Entrevistas com Embarcadores - PLI 2050</p>
            </div>

            <!-- Se√ß√£o 1: Introdu√ß√£o -->
            <div class="card">
                <div class="card-header">
                    <h3>üéØ Objetivo do Formul√°rio</h3>
                </div>
                <div class="card-body">
                    <p>
                        Este formul√°rio faz parte do <strong>Plano de Log√≠stica Integrada 2050 (PLI 2050)</strong> e tem como objetivo coletar informa√ß√µes detalhadas sobre as opera√ß√µes log√≠sticas e de transporte de empresas embarcadoras no Brasil. Os dados coletados ser√£o fundamentais para o planejamento estrat√©gico da infraestrutura log√≠stica nacional.
                    </p>
                    <div class="success-box">
                        <div class="title">‚úÖ Importante</div>
                        <p>Todas as informa√ß√µes fornecidas ser√£o tratadas com confidencialidade e utilizadas exclusivamente para fins de planejamento e an√°lise estrat√©gica do setor log√≠stico brasileiro.</p>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o 2: Antes de Come√ßar -->
            <div class="card">
                <div class="card-header">
                    <h3>üìù Antes de Come√ßar</h3>
                </div>
                <div class="card-body">
                    <div class="highlight-box">
                        <div class="title">‚ö†Ô∏è Campos Obrigat√≥rios</div>
                        <p>Os campos marcados com asterisco (<strong class="red-text">*</strong>) s√£o obrigat√≥rios. O sistema n√£o permitir√° salvar o formul√°rio sem preencher todos esses campos.</p>
                    </div>

                    <div class="info-box">
                        <div class="title">üíæ Salvamento Autom√°tico</div>
                        <p>Ao clicar em "Salvar Respostas":</p>
                        <ul class="margin-top-half">
                            <li>‚úì Os dados s√£o salvos no navegador (IndexedDB)</li>
                            <li>‚úì Um arquivo Excel √© gerado automaticamente</li>
                            <li>‚úì O download inicia automaticamente</li>
                            <li>‚úì Um popup de confirma√ß√£o aparecer√°</li>
                        </ul>
                    </div>

                    <p><strong>Documentos necess√°rios:</strong></p>
                    <ul class="instruction-list">
                        <li>üìä Dados de movimenta√ß√£o anual de cargas (toneladas/ano)</li>
                        <li>üìç Informa√ß√µes de origem e destino dos transportes</li>
                        <li>üí∞ Custos de transporte e valores de carga</li>
                        <li>üìè Dist√¢ncias percorridas (em quil√¥metros)</li>
                        <li>‚è±Ô∏è Tempos de transporte (dias, horas e minutos)</li>
                    </ul>
                </div>
            </div>

            <!-- Se√ß√£o 3: Guia por Se√ß√µes -->
            <div class="card">
                <div class="card-header">
                    <h3>üìë Guia de Preenchimento por Se√ß√£o</h3>
                </div>
                <div class="card-body">
                    <!-- Cards 1-8 com instru√ß√µes detalhadas -->
                    <div class="subsection">
                        <div class="subsection-title">
                            <span class="number">1</span>
                            <span>Dados do Entrevistado</span>
                        </div>
                        <p><span class="question-reference">Perguntas 1-4</span></p>
                        <ul class="instruction-list">
                            <li><strong>Nome completo:</strong> Informe o nome completo da pessoa respons√°vel pelas informa√ß√µes log√≠sticas</li>
                            <li><strong>Fun√ß√£o:</strong> Cargo ou posi√ß√£o na empresa (ex: Gerente de Log√≠stica, Coordenador de Transportes)</li>
                            <li><strong>Telefone:</strong> N√∫mero com DDD para contato (ex: (11) 98765-4321)</li>
                            <li><strong>E-mail:</strong> E-mail corporativo ou pessoal para comunica√ß√£o</li>
                        </ul>
                    </div>

                    <div class="subsection">
                        <div class="subsection-title">
                            <span class="number">2</span>
                            <span>Dados da Empresa</span>
                        </div>
                        <p class="instruction-text"><span class="question-reference">Perguntas 5-7</span></p>
                        <ul class="instruction-list">
                            <li><strong>Tipo de empresa:</strong> Selecione o segmento (ind√∫stria, varejo, atacado, etc.). Se selecionar "Outro", especifique no campo adicional</li>
                            <li><strong>Nome da empresa:</strong> Raz√£o social ou nome fantasia</li>
                            <li><strong>Munic√≠pio:</strong> Cidade onde a empresa est√° localizada (incluir estado: ex: S√£o Paulo-SP)</li>
                        </ul>
                    </div>

                    <div class="subsection">
                        <div class="subsection-title">
                            <span class="number">3</span>
                            <span>Produtos Transportados (Tabela Din√¢mica)</span>
                        </div>
                        <p class="instruction-text"><span class="question-reference">Pergunta 8</span></p>
                        
                        <div class="highlight-box">
                            <div class="title"><span class="tip-icon">üí°</span> Como usar a tabela de produtos</div>
                            <ol class="margin-top-half padding-left-1-half">
                                <li>Clique em <strong>"+ Adicionar Produto"</strong> para criar uma nova linha</li>
                                <li>Preencha os 7 campos para cada produto</li>
                                <li>Adicione quantos produtos forem necess√°rios</li>
                                <li>Use o bot√£o üóëÔ∏è para remover produtos</li>
                            </ol>
                        </div>

                        <div class="success-box">
                            <div class="title">‚úÖ Exporta√ß√£o no Excel</div>
                            <p>Os produtos ser√£o exportados em uma <strong>aba separada</strong> chamada "Produtos Transportados", facilitando a an√°lise.</p>
                        </div>
                    </div>

                    <div class="subsection">
                        <div class="subsection-title">
                            <span class="number">4</span>
                            <span>Produto Principal</span>
                        </div>
                        <p class="instruction-text"><span class="question-reference">Perguntas 9-10</span></p>
                        <ul class="instruction-list">
                            <li><strong>Produto mais representativo:</strong> Dentre os produtos listados acima, indique qual tem maior relev√¢ncia para a empresa (por volume ou valor)</li>
                            <li><strong>Agrupamento:</strong> Selecione a categoria que melhor classifica este produto. Se necess√°rio, selecione "Outro" e especifique</li>
                        </ul>
                        <div class="info-box">
                            <div class="title">üìå Importante</div>
                            <p>As pr√≥ximas perguntas do formul√°rio (se√ß√µes 5 a 8) devem ser respondidas <strong>considerando apenas este produto principal</strong>.</p>
                        </div>
                    </div>

                    <div class="subsection">
                        <div class="subsection-title">
                            <span class="number">5</span>
                            <span>Caracter√≠sticas do Transporte</span>
                        </div>
                        <p class="instruction-text"><span class="question-reference">Perguntas 11-28</span></p>
                        
                        <p class="instruction-text"><strong>Origem e Destino (<span class="question-reference">12-13</span>):</strong></p>
                        <ul class="instruction-list">
                            <li>Informe Pa√≠s, Estado e Munic√≠pio tanto da origem quanto do destino</li>
                            <li>Para transporte local, preencha o mesmo pa√≠s/estado</li>
                        </ul>

                        <p class="instruction-text"><strong>Modalidades de Transporte (<span class="question-reference">16</span>):</strong></p>
                        <ul class="instruction-list">
                            <li>Pode marcar <strong>m√∫ltiplas op√ß√µes</strong> se houver transporte intermodal</li>
                            <li>Exemplo: Rodovi√°rio + Ferrovi√°rio (caso use ambos)</li>
                        </ul>

                        <div class="highlight-box">
                            <div class="title"><span class="tip-icon">üí°</span> Dica</div>
                            <p>Selecione a unidade correta (kg ou toneladas). O sistema converter√° automaticamente para toneladas no Excel.</p>
                        </div>
                    </div>

                    <div class="subsection">
                        <div class="subsection-title">
                            <span class="number">6</span>
                            <span>Fatores de Decis√£o Modal</span>
                        </div>
                        <p class="instruction-text"><span class="question-reference">Perguntas 29-38</span></p>
                        
                        <div class="info-box">
                            <div class="title">üéØ Como funciona esta se√ß√£o</div>
                            <p>Para cada fator (CUSTO, TEMPO, CONFIABILIDADE, SEGURAN√áA, CAPACIDADE), voc√™ deve responder:</p>
                            <ol class="margin-top-half padding-left-1-half">
                                <li><strong>Import√¢ncia:</strong> Qual o grau de import√¢ncia deste fator? (Muito alta, Alta, M√©dia, Baixa, Muito baixa)</li>
                                <li><strong>Varia√ß√£o %:</strong> Qual percentual de varia√ß√£o faria voc√™ mudar o modal de transporte? (0-100%)</li>
                            </ol>
                        </div>

                        <div class="highlight-box">
                            <div class="title"><span class="tip-icon">üí°</span> Sensibilidade</div>
                            <p>Valores menores (ex: 5%) indicam <strong>alta sensibilidade</strong> ao fator. Valores maiores (ex: 50%) indicam <strong>baixa sensibilidade</strong>.</p>
                        </div>
                    </div>

                    <div class="subsection">
                        <div class="subsection-title">
                            <span class="number">7</span>
                            <span>An√°lise Estrat√©gica</span>
                        </div>
                        <p class="instruction-text"><span class="question-reference">Perguntas 39-41</span></p>
                        <ul class="instruction-list">
                            <li><strong>Tipo de Cadeia (<span class="question-reference">39</span>):</strong> Indique se √© cadeia de suprimento (compra/recebimento) ou distribui√ß√£o (venda/entrega)</li>
                            <li><strong>Modais Alternativos (<span class="question-reference">40</span>):</strong> Pode marcar m√∫ltiplas op√ß√µes. Indique quais modais voc√™ consideraria usar</li>
                            <li><strong>Fator Adicional (<span class="question-reference">41</span>):</strong> Campo aberto para mencionar outros fatores importantes n√£o listados anteriormente</li>
                        </ul>
                    </div>

                    <div class="subsection">
                        <div class="subsection-title">
                            <span class="number">8</span>
                            <span>Dificuldades Log√≠sticas</span>
                        </div>
                        <p class="instruction-text"><span class="question-reference">Perguntas 42-43</span></p>
                        <ul class="instruction-list">
                            <li><strong>Principais dificuldades (<span class="question-reference">42</span>):</strong> Pode marcar m√∫ltiplas op√ß√µes que representem os desafios enfrentados</li>
                            <li><strong>Detalhamento (<span class="question-reference">43</span>):</strong> Use este campo para explicar melhor as dificuldades ou adicionar informa√ß√µes relevantes</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o 4: Salvamento e Exporta√ß√£o -->
            <div class="card">
                <div class="card-header">
                    <h3>üíæ Salvamento e Exporta√ß√£o dos Dados</h3>
                </div>
                <div class="card-body">
                    <div class="subsection">
                        <div class="subsection-title">
                            <span class="number">1</span>
                            <span>Valida√ß√£o Autom√°tica</span>
                        </div>
                        <p>Ao clicar em <strong>"üíæ Salvar Respostas"</strong>, o sistema ir√°:</p>
                        <ul class="instruction-list">
                            <li>‚úì Verificar se todos os campos obrigat√≥rios foram preenchidos</li>
                            <li>‚úì Mostrar um popup listando as perguntas n√£o preenchidas (se houver)</li>
                            <li>‚úì Focar automaticamente na primeira pergunta com erro</li>
                        </ul>
                        <div class="highlight-box">
                            <div class="title">‚ö†Ô∏è Aten√ß√£o</div>
                            <p>Se houver campos obrigat√≥rios vazios, o sistema <strong>n√£o permitir√° salvar</strong> at√© que sejam preenchidos.</p>
                        </div>
                    </div>

                    <div class="subsection">
                        <div class="subsection-title">
                            <span class="number">2</span>
                            <span>Download Autom√°tico do Excel</span>
                        </div>
                        <p class="instruction-text">Quando todos os campos estiverem preenchidos corretamente:</p>
                        <ul class="instruction-list">
                            <li>üìä Um arquivo Excel ser√° gerado automaticamente</li>
                            <li>‚¨áÔ∏è O download iniciar√° automaticamente</li>
                            <li>‚úÖ Um popup de confirma√ß√£o aparecer√° com link para download</li>
                        </ul>

                        <div class="success-box">
                            <div class="title">üìÅ Estrutura do Arquivo Excel</div>
                            <p><strong>Aba 1 - "Respostas":</strong></p>
                            <ul class="margin-top-half">
                                <li>Cada empresa = 1 linha</li>
                                <li>Cada pergunta (1 a 43) = 1 coluna</li>
                            </ul>
                            <p class="margin-top-1"><strong>Aba 2 - "Produtos Transportados":</strong></p>
                            <ul class="margin-top-half">
                                <li>Cada produto = 1 linha</li>
                                <li>ID da empresa para cruzar dados</li>
                                <li>7 colunas com informa√ß√µes do produto</li>
                            </ul>
                        </div>
                    </div>

                    <div class="subsection">
                        <div class="subsection-title">
                            <span class="number">3</span>
                            <span>Visualiza√ß√£o de Dados Salvos</span>
                        </div>
                        <p class="instruction-text">Para visualizar ou exportar dados salvos anteriormente:</p>
                        <ul class="instruction-list">
                            <li>Clique na aba <strong>"üìä Respostas"</strong> no menu superior</li>
                            <li>Visualize todas as entrevistas realizadas</li>
                            <li>Use os bot√µes de exporta√ß√£o: Excel, CSV ou PDF</li>
                            <li>Edite ou exclua respostas se necess√°rio</li>
                        </ul>
                    </div>

                    <div class="subsection">
                        <div class="subsection-title">
                            <span class="number">4</span>
                            <span>Analytics e An√°lises</span>
                        </div>
                        <p class="instruction-text">Acesse a aba <strong>"üìà Analytics"</strong> para visualizar:</p>
                        <ul class="instruction-list">
                            <li>üìä KPIs (Indicadores-chave): Total de entrevistas, dist√¢ncia m√©dia, custo m√©dio, etc.</li>
                            <li>üìà 12 gr√°ficos interativos com an√°lises de modalidades, produtos, fatores de decis√£o</li>
                            <li>üéØ Insights sobre padr√µes log√≠sticos</li>
                        </ul>
                    </div>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o 5: Dicas e Boas Pr√°ticas -->
            <div class="card">
                <div class="card-header">
                    <h3>üí° Dicas e Boas Pr√°ticas</h3>
                </div>
                <div class="card-body">
                    <ul class="instruction-list">
                        <li><strong>üì± Use um computador/notebook:</strong> A interface √© otimizada para telas maiores, facilitando o preenchimento da tabela de produtos</li>
                        <li><strong>üîç Revise antes de salvar:</strong> Confira todas as informa√ß√µes, especialmente valores num√©ricos e unidades</li>
                        <li><strong>üíæ Fa√ßa backup:</strong> O Excel gerado automaticamente serve como backup externo dos dados</li>
                        <li><strong>üìä Dados precisos:</strong> Forne√ßa informa√ß√µes o mais precisas poss√≠vel. Se n√£o souber o valor exato, forne√ßa uma estimativa aproximada</li>
                        <li><strong>üîÑ Dados persistentes:</strong> Os dados ficam salvos no navegador. N√£o feche a aba antes de fazer o download do Excel</li>
                        <li><strong>üåê Navegador compat√≠vel:</strong> Use Chrome, Firefox, Edge ou Safari atualizados</li>
                    </ul>

                    <div class="highlight-box">
                        <div class="title"><span class="tip-icon">üí°</span> Dica Pro</div>
                        <p>Prepare uma planilha com os dados antes de come√ßar o preenchimento. Isso agiliza o processo e reduz erros.</p>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o 6: Suporte -->
            <div class="card">
                <div class="card-header">
                    <h3>‚ùì D√∫vidas e Suporte</h3>
                </div>
                <div class="card-body">                    <div class="info-box">
                        <div class="title">üìû Precisa de ajuda?</div>
                        <p>Em caso de d√∫vidas sobre o preenchimento ou problemas t√©cnicos, entre em contato com a equipe do PLI 2050.</p>
                        <p class="margin-top-1"><strong>Informa√ß√µes de contato:</strong></p>
                        <ul class="margin-top-half">
                            <li>üìß E-mail: pli2050@infraestrutura.gov.br</li>
                            <li>üåê Website: www.pli2050.gov.br</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>

    <!-- P√°gina 5: Visualizador de Dados -->
    <div id="page-visualizador" class="page">
        <div class="container">
            <div class="page-header">
                <h2>üóÑÔ∏è Visualizador de Dados IndexedDB</h2>
                <p>Ferramenta completa para inspecionar e gerenciar os dados armazenados localmente</p>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3>üìä Informa√ß√µes do Banco de Dados</h3>
                </div>
                <div class="card-body">
                    <table class="example-table">
                        <tr>
                            <th>Nome do Banco</th>
                            <td>PLI2050_Database</td>
                        </tr>
                        <tr>
                            <th>Object Store</th>
                            <td>respostas</td>
                        </tr>
                        <tr>
                            <th>Tipo de Armazenamento</th>
                            <td>IndexedDB (Browser Local Storage)</td>
                        </tr>
                        <tr>
                            <th>Persist√™ncia</th>
                            <td>Dados permanecem at√© serem exclu√≠dos manualmente ou ao limpar dados do navegador</td>
                        </tr>
                    </table>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3>üåê Navegador e Localiza√ß√£o dos Dados</h3>
                </div>
                <div class="card-body">
                    <p><strong>Navegador Detectado:</strong> <span id="browser-name-vis"></span></p>
                    <p><strong>Caminho Prov√°vel do Banco de Dados:</strong></p>
                    <div id="storage-path-vis" class="margin-top-half storage-path-display"></div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3>üîç Ferramentas de Visualiza√ß√£o</h3>
                </div>
                <div class="card-body">
                    <div class="button-group">
                        <button onclick="loadDataVisualizer()" class="btn-primary">
                            üìÇ Carregar Dados
                        </button>
                        <button onclick="showRawDataVisualizer()" class="btn-secondary">
                            üìù Ver JSON Bruto
                        </button>
                        <button onclick="calculateSizeVisualizer()" class="btn-secondary">
                            üìè Calcular Tamanho
                        </button>
                    </div>

                    <div id="data-container-vis" class="margin-top-2">
                        <p class="empty-state">
                            ‚ÑπÔ∏è Clique em "Carregar Dados" para visualizar as respostas armazenadas
                        </p>
                    </div>

                    <div id="raw-data-container-vis" class="raw-data-container">
                        <h4>üìÑ JSON Bruto</h4>
                        <pre id="raw-data-display-vis" class="raw-data-display"></pre>
                    </div>

                    <div id="size-info-vis" class="margin-top-2"></div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3>üìä Estat√≠sticas de Uso</h3>
                </div>
                <div class="card-body">
                    <div id="stats-container-vis">
                        <p class="empty-state-small">
                            ‚ÑπÔ∏è As estat√≠sticas ser√£o exibidas ap√≥s carregar os dados
                        </p>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3>üõ†Ô∏è Ferramentas de Desenvolvedor do Navegador</h3>
                </div>
                <div class="card-body">
                    <p>Para visualizar o IndexedDB diretamente nas ferramentas de desenvolvedor:</p>
                    <ol class="instruction-list">
                        <li>
                            <strong>Google Chrome / Microsoft Edge:</strong>
                            <ol class="sub-list">
                                <li>Pressione F12 ou clique com bot√£o direito ‚Üí "Inspecionar"</li>
                                <li>V√° para a aba "Application" (ou "Aplicativo")</li>
                                <li>No menu lateral, expanda "Storage" ‚Üí "IndexedDB"</li>
                                <li>Clique em "PLI2050_Database" ‚Üí "respostas"</li>
                            </ol>
                        </li>
                        <li>
                            <strong>Mozilla Firefox:</strong>
                            <ol class="sub-list">
                                <li>Pressione F12 ou clique com bot√£o direito ‚Üí "Inspecionar Elemento"</li>
                                <li>V√° para a aba "Storage" (ou "Armazenamento")</li>
                                <li>Expanda "IndexedDB" no menu lateral</li>
                                <li>Clique em "PLI2050_Database" ‚Üí "respostas"</li>
                            </ol>
                        </li>
                        <li>
                            <strong>Safari:</strong>
                            <ol class="sub-list">
                                <li>Ative o menu Desenvolvedor em Prefer√™ncias ‚Üí Avan√ßado</li>
                                <li>Menu Desenvolvedor ‚Üí "Mostrar Inspetor Web"</li>
                                <li>V√° para a aba "Storage"</li>
                                <li>Expanda "IndexedDB" ‚Üí "PLI2050_Database" ‚Üí "respostas"</li>
                            </ol>
                        </li>
                    </ol>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3>‚ÑπÔ∏è Sobre o Armazenamento IndexedDB</h3>
                </div>
                <div class="card-body">
                    <ul class="instruction-list">
                        <li><strong>Capacidade:</strong> O IndexedDB pode armazenar grandes volumes de dados (geralmente limitado apenas pelo espa√ßo em disco dispon√≠vel)</li>
                        <li><strong>Seguran√ßa:</strong> Os dados s√£o armazenados localmente no computador do usu√°rio e n√£o s√£o enviados para nenhum servidor</li>
                        <li><strong>Privacidade:</strong> Cada dom√≠nio tem seu pr√≥prio banco de dados isolado, outros sites n√£o podem acessar estes dados</li>
                        <li><strong>Sincroniza√ß√£o:</strong> Os dados N√ÉO s√£o sincronizados entre dispositivos ou navegadores diferentes</li>
                        <li><strong>Backup:</strong> √â responsabilidade do usu√°rio fazer backup dos dados exportando-os regularmente atrav√©s da p√°gina "Respostas"</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- ============================================================ -->
    <!-- SCRIPTS REFATORADOS - PLI 2050 v2.0.0 (06/11/2025)        -->
    <!-- Arquitetura modular: Frontend = UI pura, Backend = L√≥gica  -->
    <!-- ============================================================ -->
    
    <!-- Biblioteca XLSX para gera√ß√£o de Excel -->
    <script src="/vendor/xlsx.full.min.js"></script>
    
    <!-- 1. API Client - Interface √∫nica com backend FastAPI -->
    <script src="/js/api.js?v=20251106d"></script>
    
    <!-- 2. UI Manager - Gerencia toda interface visual (modais, feedback, navega√ß√£o) -->
    <script src="/js/ui.js?v=20251106d"></script>
    
    <!-- 3. Form Manager - Coleta dados e submete para backend -->
    <script src="/js/form.js?v=20251106d"></script>
    
    <!-- 4. CNPJ Auto-Fill - Preenche dados automaticamente via Receita Federal -->
    <script src="/js/cnpj-autofill.js?v=20251106d"></script>
</body>
</html>
